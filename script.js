
const pensum = {"Semestre 1": [{"codigo": "2094101", "nombre": "Pr\u00e1ctica Pedag\u00f3gica I", "creditos": 3}, {"codigo": "2094102", "nombre": "Introducci\u00f3n a la literatura", "creditos": 3}, {"codigo": "2094103", "nombre": "Taller de producci\u00f3n e interpretaci\u00f3n textual", "creditos": 3}, {"codigo": "2094104", "nombre": "Introducci\u00f3n a los estudios del lenguaje", "creditos": 3}, {"codigo": "2059004", "nombre": "Historia, im\u00e1genes y concepciones del maestro", "creditos": 3}, {"codigo": "2059007", "nombre": "Did\u00e1cticas, saberes y evaluaci\u00f3n", "creditos": 3}], "Semestre 2": [{"codigo": "2094201", "nombre": "Pr\u00e1ctica pedag\u00f3gica II", "creditos": 3, "prerequisitos": ["2094101"]}, {"codigo": "2094202", "nombre": "Teor\u00edas Literarias I", "creditos": 3}, {"codigo": "2094203", "nombre": "Fon\u00e9tica y fonolog\u00eda", "creditos": 3}, {"codigo": "2094304", "nombre": "Morfolog\u00eda", "creditos": 3}, {"codigo": "2059002", "nombre": "Sujetos en el acto educativo", "creditos": 3}, {"codigo": "2059008", "nombre": "Cognici\u00f3n, cultura y aprendizaje", "creditos": 3}], "Semestre 3": [{"codigo": "2094301", "nombre": "Pr\u00e1ctica Pedag\u00f3gica III", "creditos": 3, "prerequisitos": ["2094201"]}, {"codigo": "2094302", "nombre": "Teor\u00edas literarias II", "creditos": 3, "prerequisitos": ["2094202"]}, {"codigo": "2094303", "nombre": "Literaturas griega y latina", "creditos": 3, "prerequisitos": ["2094102"]}, {"codigo": "2094404", "nombre": "Sintaxis", "creditos": 3, "prerequisitos": ["2094304"]}, {"codigo": "2059001", "nombre": "Educaci\u00f3n Popular", "creditos": 3}, {"codigo": "9120101", "nombre": "English 1", "creditos": 3}], "Semestre 4": [{"codigo": "2094401", "nombre": "Pr\u00e1ctica Pedag\u00f3gica IV", "creditos": 4, "prerequisitos": ["2094301"]}, {"codigo": "2094402", "nombre": "Poes\u00eda", "creditos": 3, "prerequisitos": ["2094202"]}, {"codigo": "2094403", "nombre": "Dramaturgia y teatro", "creditos": 3, "prerequisitos": ["2094303"]}, {"codigo": "2094204", "nombre": "Historia de la Lengua", "creditos": 3, "prerequisitos": ["2094404"]}, {"codigo": "2059005", "nombre": "Teor\u00edas curriculares", "creditos": 3}, {"codigo": "9120102", "nombre": "English 2", "creditos": 3, "prerequisitos": ["9120101"]}], "Semestre 5": [{"codigo": "2094501", "nombre": "Pr\u00e1ctica Pedag\u00f3gica V", "creditos": 5, "prerequisitos": ["2094401"]}, {"codigo": "2094502", "nombre": "Ensayo", "creditos": 3, "prerequisitos": ["2094302"]}, {"codigo": "2094503", "nombre": "Sem\u00e1ntica", "creditos": 3, "prerequisitos": ["2094404"]}, {"codigo": "2094504", "nombre": "Proyecto de Psicoling\u00fc\u00edstica", "creditos": 3, "prerequisitos": ["2094401"]}, {"codigo": "2059003", "nombre": "Tradiciones pedag\u00f3gicas", "creditos": 3}, {"codigo": "9120103", "nombre": "English 3", "creditos": 2, "prerequisitos": ["9120102"]}], "Semestre 6": [{"codigo": "2094601", "nombre": "Pr\u00e1ctica Pedag\u00f3gica VI", "creditos": 5, "prerequisitos": ["2094501"]}, {"codigo": "2094602", "nombre": "Literatura espa\u00f1ola", "creditos": 3, "prerequisitos": ["2094302"]}, {"codigo": "2094603", "nombre": "Seminario tem\u00e1tico", "creditos": 3, "prerequisitos": ["2094302"]}, {"codigo": "2094604", "nombre": "Proyecto de Pragm\u00e1tica", "creditos": 3, "prerequisitos": ["2094404"]}, {"codigo": "2059006", "nombre": "Legislaci\u00f3n educativa", "creditos": 3}, {"codigo": "9120104", "nombre": "English 4", "creditos": 2, "prerequisitos": ["9120103"]}], "Semestre 7": [{"codigo": "2094701", "nombre": "Pr\u00e1ctica Pedag\u00f3gica VII", "creditos": 5, "prerequisitos": ["2094601"]}, {"codigo": "2094702", "nombre": "Literatura europea", "creditos": 3, "prerequisitos": ["2094302"]}, {"codigo": "2094703", "nombre": "Proyecto socioling\u00fc\u00edstica", "creditos": 3, "prerequisitos": ["2094404"]}, {"codigo": "2059015", "nombre": "Educaci\u00f3n e inclusi\u00f3n", "creditos": 3, "creditos_minimos": 70}, {"codigo": "2022041", "nombre": "Razonamiento abstracto", "creditos": 3, "creditos_minimos": 70}, {"codigo": "9120105", "nombre": "English 5", "creditos": 2, "prerequisitos": ["9120104"]}], "Semestre 8": [{"codigo": "2094801", "nombre": "Pr\u00e1ctica Pedag\u00f3gica VIII", "creditos": 8, "prerequisitos": ["2094701"]}, {"codigo": "2094802", "nombre": "Investigaci\u00f3n literaria", "creditos": 3, "prerequisitos": ["2094502"]}, {"codigo": "2094803", "nombre": "Semi\u00f3tica de la cultura", "creditos": 3, "prerequisitos": ["2094404"]}, {"codigo": "electiva1", "nombre": "Electiva I", "creditos": 3, "creditos_minimos": 70}, {"codigo": "2059014", "nombre": "Formaci\u00f3n ciudadana", "creditos": 2}], "Semestre 9": [{"codigo": "2094901", "nombre": "Pr\u00e1ctica Pedag\u00f3gica IX", "creditos": 8, "prerequisitos": ["2094801"]}, {"codigo": "2094902", "nombre": "Literatura latinoamericana", "creditos": 3, "prerequisitos": ["2094302"]}, {"codigo": "2094903", "nombre": "Ling\u00fc\u00edstica", "creditos": 3, "prerequisitos": ["2094604"]}, {"codigo": "electiva2", "nombre": "Electiva II", "creditos": 3, "creditos_minimos": 70}], "Semestre 10": [{"codigo": "2094010", "nombre": "Trabajo de grado", "creditos": 6, "prerequisitos": ["2094901"]}, {"codigo": "2094020", "nombre": "Literatura colombiana", "creditos": 3, "prerequisitos": ["2094302"]}, {"codigo": "electiva3", "nombre": "Electiva III", "creditos": 3, "creditos_minimos": 70}, {"codigo": "electiva4", "nombre": "Electiva IV", "creditos": 3, "creditos_minimos": 70}]};

function cargarEstado() {
  return JSON.parse(localStorage.getItem("estadoPensum") || "{}");
}

function guardarEstado(estado) {
  localStorage.setItem("estadoPensum", JSON.stringify(estado));
}

function contarCreditos(estado) {
  let total = 0;
  for (let semestre in pensum) {
    for (let materia of pensum[semestre]) {
      if (estado[materia.codigo]) {
        total += materia.creditos;
      }
    }
  }
  return total;
}

function puedeSeleccionarse(materia, estado) {
  if (materia.prerequisitos) {
    for (let pr of materia.prerequisitos) {
      if (!estado[pr]) return false;
    }
  }
  if (materia.creditos_minimos) {
    return contarCreditos(estado) >= materia.creditos_minimos;
  }
  return true;
}

function render() {
  const contenedor = document.getElementById("contenedor");
  contenedor.innerHTML = "";
  const estado = cargarEstado();

  for (let [semestre, materias] of Object.entries(pensum)) {
    const div = document.createElement("div");
    div.className = "semestre";
    const h2 = document.createElement("h2");
    h2.textContent = semestre;
    div.appendChild(h2);

    for (let materia of materias) {
      const boton = document.createElement("div");
      boton.className = "materia";
      boton.textContent = materia.nombre;
      if (estado[materia.codigo]) boton.classList.add("completada");
      else if (!puedeSeleccionarse(materia, estado)) boton.classList.add("desactivada");

      boton.addEventListener("click", () => {
        if (!puedeSeleccionarse(materia, estado)) return;
        estado[materia.codigo] = !estado[materia.codigo];
        guardarEstado(estado);
        render();
      });
      div.appendChild(boton);
    }

    contenedor.appendChild(div);
  }
}

document.addEventListener("DOMContentLoaded", render);
